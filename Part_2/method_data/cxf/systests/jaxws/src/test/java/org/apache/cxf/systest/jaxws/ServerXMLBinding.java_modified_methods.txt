Method: run
VULNERABLE VERSION:


    protected void run() {
        Object implementor = new GreeterImpl();
        String address = "http://localhost:" + REG_PORT + "/XMLService/XMLPort";
        Endpoint.publish(address, implementor);

        Object implementor1 = new org.apache.hello_world_xml_http.wrapped.GreeterImpl();
        address = "http://localhost:" + WRAP_PORT + "/XMLService/XMLPort";
        Endpoint.publish(address, implementor1);

        Object faultImplementor = new GreeterFaultImpl();
        String faultAddress = "http://localhost:" + REG_PORT + "/XMLService/XMLFaultPort";
        Endpoint.publish(faultAddress, faultImplementor);

        Object implementor2 = new HeaderTesterImpl();
        address = "http://localhost:" + REG_PORT + "/XMLContext/XMLPort";
        Endpoint.publish(address, implementor2);
        
        Object implementor3 = new org.apache.hello_world_xml_http.mixed.GreeterImpl();
        address = "http://localhost:" + MIX_PORT + "/XMLService/XMLPort";
        Endpoint.publish(address, implementor3);
    }
FIXED VERSION:

    protected void run() {
        Object implementor = new GreeterImpl();
        String address = "http://localhost:" + REG_PORT + "/XMLService/XMLPort";
        eps.add(Endpoint.publish(address, implementor));
        
        ((EndpointImpl)eps.get(0)).getService().getInInterceptors().add(new URIMappingInterceptor());

        Object implementor1 = new org.apache.hello_world_xml_http.wrapped.GreeterImpl();
        address = "http://localhost:" + WRAP_PORT + "/XMLService/XMLPort";
        eps.add(Endpoint.publish(address, implementor1));

        Object faultImplementor = new GreeterFaultImpl();
        String faultAddress = "http://localhost:" + REG_PORT + "/XMLService/XMLFaultPort";
        eps.add(Endpoint.publish(faultAddress, faultImplementor));

        Object implementor2 = new HeaderTesterImpl();
        address = "http://localhost:" + REG_PORT + "/XMLContext/XMLPort";
        eps.add(Endpoint.publish(address, implementor2));
        
        Object implementor3 = new org.apache.hello_world_xml_http.mixed.GreeterImpl();
        address = "http://localhost:" + MIX_PORT + "/XMLService/XMLPort";
        eps.add(Endpoint.publish(address, implementor3));
    }
================================================================================
