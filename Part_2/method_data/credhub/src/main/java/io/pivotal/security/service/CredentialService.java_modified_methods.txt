Method: verifyCredentialWritePermission
VULNERABLE VERSION:


  private void verifyCredentialWritePermission(UserContext userContext, String credentialName) {
    if (!permissionService.hasPermission(userContext.getAclUser(), credentialName, WRITE)) {
      throw new PermissionException("error.acl.lacks_credential_write");
    }
  }
FIXED VERSION:


  private void verifyCredentialWritePermission(UserContext userContext, String credentialName) {
    if (!permissionService.hasPermission(userContext.getAclUser(), credentialName, WRITE)) {
      throw new PermissionException("error.credential.invalid_access");
    }
  }
================================================================================
Method: verifyAclWrite
VULNERABLE VERSION:


  private void verifyAclWrite(UserContext userContext, String credentialName) {
    if (!permissionService.hasPermission(userContext.getAclUser(), credentialName, WRITE_ACL)) {
      throw new PermissionException("error.acl.lacks_credential_write");
    }
  }
FIXED VERSION:


  private void verifyAclWrite(UserContext userContext, String credentialName) {
    if (!permissionService.hasPermission(userContext.getAclUser(), credentialName, WRITE_ACL)) {
      throw new PermissionException("error.credential.invalid_access");
    }
  }
================================================================================
