Method: displaysErrorWhenPasswordContravenesPolicy
VULNERABLE VERSION:

    public void displaysErrorWhenPasswordContravenesPolicy() {
        //the only policy we can contravene by default is the length

        String newPassword = new RandomValueStringGenerator(260).generate();

        signIn(userEmail, PASSWORD);

        changePassword(PASSWORD, newPassword, newPassword);
        WebElement errorMessage = webDriver.findElement(By.className("error-message"));
        assertTrue(errorMessage.isDisplayed());
        assertEquals("Password must be no more than 255 characters in length.", errorMessage.getText());
    }
FIXED VERSION:

    public void displaysErrorWhenPasswordContravenesPolicy() {
        //the only policy we can contravene by default is the length

        String newPassword = new RandomValueStringGenerator(260).generate();
        webDriver.get(baseUrl + "/change_password");
        signIn(userEmail, PASSWORD);

        changePassword(PASSWORD, newPassword, newPassword);
        WebElement errorMessage = webDriver.findElement(By.className("error-message"));
        assertTrue(errorMessage.isDisplayed());
        assertEquals("Password must be no more than 255 characters in length.", errorMessage.getText());
    }
================================================================================
Method: signIn
VULNERABLE VERSION:


    private void signIn(String userName, String password) {
        webDriver.get(baseUrl + "/logout.do");
        webDriver.get(baseUrl + "/login");
        webDriver.findElement(By.name("username")).sendKeys(userName);
        webDriver.findElement(By.name("password")).sendKeys(password);
        webDriver.findElement(By.xpath("//input[@value='Sign in']")).click();
        assertThat(webDriver.findElement(By.cssSelector("h1")).getText(), containsString("Where to?"));
    }
FIXED VERSION:


    private void signIn(String userName, String password) {
        webDriver.findElement(By.name("username")).sendKeys(userName);
        webDriver.findElement(By.name("password")).sendKeys(password);
        webDriver.findElement(By.xpath("//input[@value='Sign in']")).click();
    }
================================================================================
