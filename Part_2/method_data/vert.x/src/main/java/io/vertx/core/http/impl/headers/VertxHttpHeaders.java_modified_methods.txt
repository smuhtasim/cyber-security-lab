Method: add0
VULNERABLE VERSION:


  private void add0(int h, int i, final CharSequence name, final CharSequence value) {
    // Update the hash table.
    VertxHttpHeaders.MapEntry e = entries[i];
    VertxHttpHeaders.MapEntry newEntry;
    entries[i] = newEntry = new VertxHttpHeaders.MapEntry(h, name, value);
    newEntry.next = e;

    // Update the linked list.
    newEntry.addBefore(head);
  }
FIXED VERSION:


  private void add0(int h, int i, final CharSequence name, final CharSequence value) {
    if (!(name instanceof AsciiString)) {
      HttpUtils.validateHeader(name);
    }
    if (!(value instanceof AsciiString)) {
      HttpUtils.validateHeader(value);
    }
    // Update the hash table.
    VertxHttpHeaders.MapEntry e = entries[i];
    VertxHttpHeaders.MapEntry newEntry;
    entries[i] = newEntry = new VertxHttpHeaders.MapEntry(h, name, value);
    newEntry.next = e;

    // Update the linked list.
    newEntry.addBefore(head);
  }
================================================================================
