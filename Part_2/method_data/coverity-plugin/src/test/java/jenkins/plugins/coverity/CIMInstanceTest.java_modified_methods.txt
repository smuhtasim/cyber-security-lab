Method: doCheck_invalidWSResponseCode
VULNERABLE VERSION:

    public void doCheck_invalidWSResponseCode() {
        testWsFactory.setWSResponseCode(401, "failed response message");
        final String expectedErrorMessage = "Connection check failed." + System.lineSeparator() +
            "Check Coverity Web Service Response: { Code=401, Message=\"failed response message\" }" + System.lineSeparator() +
            "(check that the values entered for this instance are correct and ensure the Coverity Connect version is at least " +
            CoverityVersion.MINIMUM_SUPPORTED_VERSION.toString() + ")";

        CIMInstance cimInstance = new CIMInstanceBuilder().withName("test").withHost("test.coverity").withPort(8080)
                .withUser("admin").withPassword("password").withUseSSL(false).withCredentialId("").build();

        FormValidation result = cimInstance.doCheck();

        assertEquals(Kind.ERROR, result.kind);
        assertEquals(expectedErrorMessage, StringEscapeUtils.unescapeHtml(result.getMessage()).replace("<br>", "\n"));
    }
FIXED VERSION:

    public void doCheck_invalidWSResponseCode() {
        testWsFactory.setWSResponseCode(401, "failed response message");
        final String expectedErrorMessage = "Connection check failed." + System.lineSeparator() +
            "Check Coverity Web Service Response: { Code=401, Message=\"failed response message\" }" + System.lineSeparator() +
            "(check that the values entered for this instance are correct and ensure the Coverity Connect version is at least " +
            CoverityVersion.MINIMUM_SUPPORTED_VERSION.toString() + ")";
        CredentialUtil.setCredentialManager("admin", "password");

        CIMInstance cimInstance = new CIMInstanceBuilder().withName("test").withHost("test.coverity").withPort(8080)
                .withUseSSL(false).withDefaultCredentialId().build();

        FormValidation result = cimInstance.doCheck();

        assertEquals(Kind.ERROR, result.kind);
        assertEquals(expectedErrorMessage, StringEscapeUtils.unescapeHtml(result.getMessage()).replace("<br>", "\n"));
    }
================================================================================
