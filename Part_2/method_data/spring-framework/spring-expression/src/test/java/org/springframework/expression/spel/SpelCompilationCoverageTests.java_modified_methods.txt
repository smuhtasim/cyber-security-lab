Method: failsWhenSettingContextForExpression_SPR12326
VULNERABLE VERSION:

	public void failsWhenSettingContextForExpression_SPR12326() {
		SpelExpressionParser parser = new SpelExpressionParser(
				new SpelParserConfiguration(SpelCompilerMode.IMMEDIATE, getClass().getClassLoader()));
		Person3 person = new Person3("foo", 1);
		SpelExpression expression = parser.parseRaw("#it?.age?.equals([0])");
		StandardEvaluationContext context = new StandardEvaluationContext(new Object[] {1});
		context.setVariable("it", person);
		expression.setEvaluationContext(context);
		assertTrue(expression.getValue(Boolean.class));
		assertTrue(expression.getValue(Boolean.class));
		assertCanCompile(expression);
		assertTrue(expression.getValue(Boolean.class));
	}
FIXED VERSION:

	public void failsWhenSettingContextForExpression_SPR12326() {
		SpelExpressionParser parser = new SpelExpressionParser(
				new SpelParserConfiguration(SpelCompilerMode.OFF, getClass().getClassLoader()));
		Person3 person = new Person3("foo", 1);
		SpelExpression expression = parser.parseRaw("#it?.age?.equals([0])");
		StandardEvaluationContext context = new StandardEvaluationContext(new Object[] {1});
		context.setVariable("it", person);
		expression.setEvaluationContext(context);
		assertTrue(expression.getValue(Boolean.class));
		// This will trigger compilation (second usage)
		assertTrue(expression.getValue(Boolean.class));
		context.setVariable("it", null);
		assertNull(expression.getValue(Boolean.class));
		
		assertCanCompile(expression);
		
		context.setVariable("it", person);
		assertTrue(expression.getValue(Boolean.class));
		context.setVariable("it", null);
		assertNull(expression.getValue(Boolean.class));
	}
================================================================================
