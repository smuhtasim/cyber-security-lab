Method: generateRandomSecret
VULNERABLE VERSION:


  private byte[] generateRandomSecret() {
    return Long.toString(rand.nextLong()).getBytes(Charset.forName("UTF-8"));
  }
FIXED VERSION:

  protected byte[] generateRandomSecret() {
    byte[] secret = new byte[32]; // 32 bytes = 256 bits
    rand.nextBytes(secret);
    return secret;
  }
================================================================================
